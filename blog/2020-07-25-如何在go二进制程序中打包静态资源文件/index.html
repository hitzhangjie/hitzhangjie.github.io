<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="Webç«™ç‚¹æè¿°">
<title>
å¦‚ä½•åœ¨goäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“åŒ…é™æ€èµ„æºæ–‡ä»¶ - ä»‹ç»
</title>




<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5f24f50fc2418c0012d52ac3&product=inline-share-buttons" async="async">
</script>

<style>
 
[alt~=sharing] {
    border: 0px;
    box-shadow: none;
}
div#st-1 {
    text-align: unset;
}

 
div#st-1 .st-btn {
    height: 24px;
    padding: 0 4px;
}

div#st-1 .st-btn > img {
    top: 4.2px;
}

div#st-2 .st-btn {
    height: 24px;
    padding: 0 4px;
}

div#st-2 .st-btn > img {
    top: 4.2px;
}
</style>







        
        <meta property="og:title" content="å¦‚ä½•åœ¨goäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“åŒ…é™æ€èµ„æºæ–‡ä»¶ - ä»‹ç»" />
<meta property="og:type" content="website" />
<meta property="og:description" content="Webç«™ç‚¹æè¿°"/>
<meta property="og:url" content="https://www.hitzhangjie.pro/blog/2020-07-25-%E5%A6%82%E4%BD%95%E5%9C%A8go%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%89%93%E5%8C%85%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6/"/>
<meta property="og:site_name" content="ä»‹ç»"/>




<meta property="og:image" content="https://www.hitzhangjie.pro/home/me.jpg"/>

<meta property="og:image" content="https://www.hitzhangjie.pro/home/profile.jpg"/>




        
<link rel="shortcut icon" href="/img/fav.ico">


        





<link rel="stylesheet" href="/css/main.min.24b21e0909abaf0ad62af509780fea401864367fe10c0d7ffcd89778c9dac466.css" integrity="sha256-JLIeCQmrrwrWKvUJeA/qQBhkNn/hDA1//NiXeMnaxGY=" crossorigin="anonymous" media="screen">




    <link rel="stylesheet" href="/custom.css" integrity="" crossorigin="anonymous" media="screen">

        
        
        
        
    </head>
    <body>
        <section id="top" class="section">
            
            <div class="container hero  fade-in one ">
                

    <h1 class="bold-title is-1">åšå®¢</h1>


            </div>
            
            <div class="section  fade-in two ">
                
<div class="container">
    <hr>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbar-menu " id="navMenu">
            
            
            
            
            <a class="navbar-item" href="/">ä¸»é¡µ</a>
            

            
            

            
                
            

            
                
            

            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://www.hitzhangjie.pro/projects/">
                  
                  
                  é¡¹ç›®
                  
                  
                  </a>
                
                
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://www.hitzhangjie.pro/blog/">
                  
                  è¿”å› åšå®¢
                  
                  </a>
                
                
            
            
            
            
            
            <a class="navbar-item" href="/#about">å…³äº</a>
            
            
            
            
            
            <a class="navbar-item" href="/#thanks">è‡´è°¢</a>
            
            
            
            

            
            
            <a class="navbar-item" href="/#contact">è”ç³»æ–¹å¼</a>
            
            

            
            
            
            
            <a class="navbar-item" href="https://www.hitzhangjie.pro/en/">English</a>
            
            

            
            
        </div>
    </nav>
    <hr>
</div>



                
    <div class="container">

        <h2 class="title is-1 top-pad strong-post-title">
            <a href="https://www.hitzhangjie.pro/blog/2020-07-25-%E5%A6%82%E4%BD%95%E5%9C%A8go%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%89%93%E5%8C%85%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6/">å¦‚ä½•åœ¨goäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“åŒ…é™æ€èµ„æºæ–‡ä»¶</a>
        </h2>
        <div class="post-data">
            å‘è¡¨æ—¶é—´ï¼š2020-07-25 <br> 
            é˜…è¯»æ—¶é•¿ï¼š5 åˆ†é’Ÿ (2431å­—)
        </div>

        
        <div>
            <div>
            
            
            <p>
                æ ‡ç­¾ï¼š
                
                <a href="/tags/go">go</a>,
                
                <a href="/tags/bindata">bindata</a>
                
            </p>
            
            </div>

            <div>
            <br>
            


<div style="display:flex;">
    <div>åˆ†äº«ï¼š</div>
    <div>
        <div class="sharethis-inline-share-buttons"></div>
    </div>
</div>


            </div>

        </div>

        
        

        
        <div> 
            
<aside>
    <hr/>
    <header>
    <b>ã€Šå¦‚ä½•åœ¨goäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“åŒ…é™æ€èµ„æºæ–‡ä»¶ã€‹ç›®å½•ï¼š</b>
    <br/>
    </header>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#why">Why?</a></li>
    <li><a href="#how">How?</a></li>
    <li><a href="#lets-do-it">Let&rsquo;s Do it!</a>
      <ul>
        <li><a href="#åŠŸèƒ½åˆ†æ">åŠŸèƒ½åˆ†æ</a></li>
        <li><a href="#åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°</a></li>
      </ul>
    </li>
  </ul>
</nav>
    <hr/>
</aside>


        </div>
   
        
        <div class="container markdown top-pad">
            
<h1 id="why" class="anchor-link"><a href="#why">Why?</a></h1>
<p>æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›åœ¨goäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“åŒ…ä¸€äº›é™æ€èµ„æºæ–‡ä»¶ï¼Œç›®çš„å¯èƒ½æœ‰å¤šç§ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯ä¸ºäº†ç®€åŒ–å®‰è£…ã€‚é€šå¸¸æˆ‘ä»¬å®‰è£…ä¸€ä¸ªgoç¼–å†™çš„å·¥å…·ï¼Œæ›´å€¾å‘äºä½¿ç”¨ <code>go get $repo</code> çš„æ–¹å¼æ¥å®Œæˆï¼Œè¿™ä¼¼ä¹å·²ç»æˆä¸ºäº†ä¸€ç§å…±è¯†ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰äº›é¡¹ç›®è¿˜ä¾èµ–ä¸€äº›é™æ€èµ„æºæ–‡ä»¶ï¼Œè¿™äº›é™æ€èµ„æºæ–‡ä»¶æ˜¯ä¸ä¼šè¢«è‡ªåŠ¨å®‰è£…çš„ï¼Œå°±éœ€è¦å€ŸåŠ©å…¶ä»–æ–¹å¼æ¥å®Œæˆé™æ€èµ„æºçš„å®‰è£…ï¼Œæ¯”å¦‚é€šè¿‡install.shè„šæœ¬ï¼Œåè€…Makefileæ„å»ºè„šæœ¬ç­‰ç­‰ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘æƒ³è®¨è®ºä¸‹ï¼Œå¦‚ä½•ç®€å•å¿«é€Ÿåœ°æ”¯æŒé™æ€èµ„æºæ‰“åŒ…åˆ°äºŒè¿›åˆ¶ç¨‹åºä¸­ï¼Œä»¥åŠåœ¨äºŒè¿›åˆ¶ç¨‹åºä¸­å¯¹è¿™äº›é™æ€èµ„æºåŠ ä»¥å¼•ç”¨ã€‚</p>

<h1 id="how" class="anchor-link"><a href="#how">How?</a></h1>
<p>githubä¸Šå·²ç»æœ‰ä¸å°‘å¼€å‘è€…åœ¨æ¢ç´¢ï¼Œæ–¹æ³•å…¶å®éƒ½æ¯”è¾ƒé›·åŒï¼Œå¤§è‡´æ€è·¯å°±æ˜¯ï¼š</p>
<ul>
<li>è¯»å–é™æ€èµ„æºæ–‡ä»¶ï¼Œè½¬æ¢æˆbytesæ•°æ®ï¼›</li>
<li>å†…éƒ¨æä¾›ä¸€äº›ç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿçš„æ¥å£ï¼Œæä¾›æ–‡ä»¶åï¼Œè¿”å›æ–‡ä»¶æ•°æ®ï¼›</li>
<li>blabla&hellip;</li>
</ul>
<p>å¼€å‘è€…çš„éœ€æ±‚ï¼Œå¯èƒ½ä¸å®Œå…¨ä¸€è‡´ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æˆ‘æƒ³åƒéå†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸€æ ·éå†æ–‡ä»¶ç›®å½•ï¼Œä¸åªæ˜¯æä¾›ä¸€ä¸ªæ–‡ä»¶åè¿”å›ä¸€ä¸ªæ–‡ä»¶ï¼›</li>
<li>æˆ‘çš„ä»£ç å·²ç»å†™å®Œäº†ï¼Œæˆ‘åªæƒ³åšæœ€å°ä¿®æ”¹ï¼Œå°†é™æ€èµ„æºæ–‡ä»¶æ‰“åŒ…åˆ°äºŒè¿›åˆ¶ç¨‹åºä¸­ï¼Œè€Œåè¿˜åŸå›æ–‡ä»¶ç³»ç»Ÿï¼›</li>
<li>æˆ‘çš„ä»£ç ä¸éœ€è¦æ”¯æŒç±»ä¼¼æ–‡ä»¶æœåŠ¡å™¨çš„åŠŸèƒ½ï¼Œä¸éœ€è¦é‚£ä¹ˆå¤šåä¸½å‘¼å“¨çš„åŠŸèƒ½ï¼›</li>
</ul>
<p>å¼€å‘è€…æä¾›äº†å¾ˆå¤šç±»ä¼¼çš„å®ç°ï¼Œè¿™é‡Œæœ‰ç¯‡æ–‡ç« å¯ä¾›å‚è€ƒï¼šhttps://tech.townsourced.com/post/embedding-static-files-in-go/ã€‚èƒ½å·¥æ¨¡å½¢ï¼Œå·§åŒ çªƒæ„ã€‚å…¶å®åœ¨å¤§è‡´äº†è§£äº†å®ç°çš„æ–¹å¼ä¹‹åï¼Œå°±æ‡’å¾—å†å»å­¦å¦‚ä½•ä½¿ç”¨è¿™äº›äº”èŠ±å…«é—¨çš„ç¬¬ä¸‰æ–¹å·¥å…·äº†ã€‚è¯´çœŸçš„ï¼ŒçœŸçš„æ²¡å‡ ä¸ªå¥½ç”¨çš„ï¼Œè‡³å°‘ä»æˆ‘çš„è§’åº¦æ¥è¯´ã€‚å¯èƒ½å®ƒè®¾è®¡çš„æ¯”è¾ƒé€šç”¨ï¼Œä½†æ˜¯ä¸æˆ‘æ¥è¯´æ²¡æœ‰ç”¨å¤„ï¼Œæˆ‘è¿½æ±‚æç®€ã€‚</p>
<p>è€Œä¸”ï¼Œgoå®˜æ–¹æ˜¯æœ‰æ„æ¥æ”¯æŒæ‰“åŒ…é™æ€èµ„æºçš„ï¼Œå…³äºè¿™ä¸€ç‚¹ï¼Œå·²ç»æœ‰issueåœ¨è·Ÿè¿›è®¨è®ºï¼šhttps://github.com/golang/go/issues/35950ã€‚</p>
<p>å°½ç®¡ç°åœ¨çš„çŠ¶æ€è¿˜æ˜¯Proposal-HoldçŠ¶æ€ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ªfeatureçš„åˆ°æ¥ä¹Ÿä¸ä¼šç­‰å¾ˆä¹…äº†ï¼Œanywayï¼Œæˆ‘ä¸æƒ³åœ¨è¿™äº›å³å°†è¢«æ·˜æ±°çš„ä¸‰æ–¹å·¥å…·ä¸Šæµªè´¹å­¦ä¹ çš„æ—¶é—´ã€æ”¹å†™ä»£ç çš„æ—¶é—´ã€‚</p>
<p>æ‰€ä»¥å‘¢ï¼Œä¸ºä»€ä¹ˆä¸ç®€å•ä¸€ç‚¹ï¼Œè‡ªå·±å†™ä¸€ä¸ªå½“ä¸‹æ¯”è¾ƒé€‚ç”¨é¡¹ç›®æœ¬èº«çš„ï¼Ÿå†™è¿™ä¸ªä¸œè¥¿èŠ±ä¸äº†äºŒååˆ†é’Ÿæ—¶é—´ï¼</p>

<h1 id="lets-do-it" class="anchor-link"><a href="#lets-do-it">Let&rsquo;s Do it!</a></h1>

<h2 id="åŠŸèƒ½åˆ†æ" class="anchor-link"><a href="#%e5%8a%9f%e8%83%bd%e5%88%86%e6%9e%90">åŠŸèƒ½åˆ†æ</a></h2>
<p>æˆ‘ç†è§£å®ç°æ‰“åŒ…é™æ€èµ„æºæ–‡ä»¶ï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªç‚¹éœ€è¦è€ƒè™‘ï¼š</p>
<ul>
<li>æä¾›ä¸€ä¸ªå°å·¥å…·ï¼Œé€šè¿‡å®ƒå¯ä»¥åå¤æ‰§è¡Œç±»ä¼¼çš„é™æ€èµ„æºæ‰“åŒ…çš„æ“ä½œï¼›</li>
<li>å¯ä»¥æŒ‡å®šä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œå°†å…¶è½¬æ¢æˆä¸€ä¸ªgoæ–‡ä»¶æ”¾å…¥é¡¹ç›®ä¸­ï¼Œå…è®¸ç¼–è¯‘æ—¶è¿æ¥ï¼›</li>
<li>goæ–‡ä»¶å¯ä»¥é€šè¿‡å¯¼å‡ºå˜é‡çš„å½¢å¼ï¼Œå¯¼å‡ºæ–‡ä»¶æ•°æ®ï¼Œå…è®¸åœ¨å…¶ä»–goä»£ç ä¸­å¼•ç”¨æ–‡ä»¶çš„å†…å®¹ï¼›</li>
<li>é™æ€èµ„æºæ–‡ä»¶å¯èƒ½æœ‰å¾ˆå¤šï¼Œå¸Œæœ›èƒ½å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œå‹ç¼©ï¼Œä»¥ä¾¿å‡å°go binaryæ–‡ä»¶å°ºå¯¸ï¼›</li>
<li>é€šå¸¸æ˜¯æœ¬åœ°ç»„ç»‡å¥½é™æ€èµ„æºæ–‡ä»¶ï¼Œå†™ä»£ç ã€æµ‹è¯•okã€æœ€åå‘å¸ƒå‰å¸Œæœ›å°†å…¶æ‰“åŒ…åˆ°go binaryï¼Œæ‰“åŒ…ã€è§£åŒ…ã€ä½¿ç”¨é™æ€èµ„æºè¦æœ€å°åŒ–é¡¹ç›®ä»£ç ä¿®æ”¹ï¼›</li>
</ul>

<h2 id="åŠŸèƒ½å®ç°" class="anchor-link"><a href="#%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0">åŠŸèƒ½å®ç°</a></h2>
<p>æˆ‘ä»¬å…ˆå®ç°è¿™ä¸ªæ‰“åŒ…é™æ€èµ„æºçš„å·¥å…·ï¼Œéœ€è¦è¿™å‡ ä¸ªå‚æ•°ï¼šinputã€outputï¼Œåˆ†åˆ«ä»£è¡¨è¾“å…¥æ–‡ä»¶ï¼ˆor ç›®å½•ï¼‰ã€è¾“å‡ºæ–‡ä»¶åï¼ˆgoæ–‡ä»¶ï¼‰ï¼Œgopkgä»£è¡¨è¾“å‡ºgoæ–‡ä»¶çš„åŒ…åï¼ˆé»˜è®¤gobinï¼‰ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#66d9ef">var</span> (
	<span style="color:#a6e22e">input</span>  = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;input&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;read data from input, which could be a regular file or directory&#34;</span>)
	<span style="color:#a6e22e">output</span> = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;output&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;write transformed data to named *.go, which could be linked with binary&#34;</span>)
	<span style="color:#a6e22e">gopkg</span>  = <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;gopkg&#34;</span>, <span style="color:#e6db74">&#34;gobin&#34;</span>, <span style="color:#e6db74">&#34;write transformed data to *.go, whose package is $package&#34;</span>)
)
</code></pre></div><p>æˆ‘ä»¬çš„å·¥å…·å°†ä»inputå¯¹åº”çš„æ–‡ä»¶ä¸­è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶è½¬æ¢æˆä¸€ä¸ªoutputå¯¹åº”çš„goæ–‡ä»¶ä¸­çš„å¯¼å‡ºå˜é‡ã€‚å¦‚æœinputæ˜¯ä¸€ä¸ªç›®å½•å‘¢ï¼Œæˆ‘ä»¬åˆ™éœ€è¦å¯¹ç›®å½•ä¸‹æ–‡ä»¶è¿›è¡Œéå†å¤„ç†ã€‚ç”±äºé™æ€èµ„æºæ–‡ä»¶æ•°æ®å¯èƒ½è¾ƒå¤§ï¼Œè¿™é‡Œéœ€è¦è¿›è¡Œgzipå‹ç¼©ï¼ˆå¯¹äºæ–‡æœ¬å‹ç¼©ç‡å¯é«˜è¾¾80%å·¦å³ï¼‰æœ‰åŠ©äºå‡å°‘go binaryæ–‡ä»¶å°ºå¯¸ã€‚</p>
<p>é‚£è¯»å–åˆ°æ–‡ä»¶å†…å®¹ä¹‹åï¼Œå¦‚ä½•å°†å…¶è½¬æ¢æˆgoæ–‡ä»¶ä¸­çš„å¯¼å‡ºå˜é‡å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªgoæ¨¡æ¿ï¼Œå°†è¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹gzipå‹ç¼©åè½¬æ¢æˆbytesæ•°ç»„ä¼ é€’ç»™æ¨¡æ¿å¼•æ“å°±å¯ä»¥äº†ã€‚æ¨¡æ¿ä¸­çš„{{.GoPackage}}å°†å¼•ç”¨å‘½ä»¤é€‰é¡¹$gopkgçš„å€¼ï¼Œ{{.Variable}}å³ä¸ºå¯¼å‡ºå˜é‡çš„å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨é€‰é¡¹$inputå¯¹åº”çš„CamelCaseè½¬æ¢ä¹‹åçš„æ–‡ä»¶åï¼ˆæˆ–ç›®å½•åï¼‰ï¼Œ{{.Data}}å³ä¸ºgzipå‹ç¼©åçš„æ–‡ä»¶æ•°æ®ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tpl</span> = <span style="color:#e6db74">`package </span><span style="color:#75715e">{{</span><span style="color:#a6e22e">.GoPackage</span><span style="color:#75715e">}}</span><span style="color:#e6db74">
</span><span style="color:#e6db74">var </span><span style="color:#75715e">{{</span><span style="color:#a6e22e">.Variable</span><span style="color:#75715e">}}</span><span style="color:#e6db74"> = []uint8{
</span><span style="color:#e6db74"></span><span style="color:#75715e">{{</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">$idx</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">$val</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">.Data</span> <span style="color:#75715e">}}{{</span><span style="color:#a6e22e">$val</span><span style="color:#75715e">}}</span><span style="color:#e6db74">,</span><span style="color:#75715e">{{</span> <span style="color:#66d9ef">end</span> <span style="color:#75715e">}}</span><span style="color:#e6db74">
</span><span style="color:#e6db74">}`</span>
</code></pre></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸‹æ€ä¹ˆè¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œå†å¼ºè°ƒä¸‹ï¼Œè¦è¯»å–çš„å†…å®¹å¯èƒ½æ˜¯å•ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªç›®å½•ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// ReadFromInputSource ä»è¾“å…¥è¯»å–å†…å®¹ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç›®å½•ï¼ˆä¼šå…ˆgzipå‹ç¼©ç„¶åå†è¿”å›å†…å®¹ï¼‰
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ReadFromInputSource</span>(<span style="color:#a6e22e">inputSource</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">data</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) {

	<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Lstat</span>(<span style="color:#a6e22e">inputSource</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
	}

	<span style="color:#a6e22e">buf</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">Buffer</span>{}
	<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">compress</span>.<span style="color:#a6e22e">Tar</span>(<span style="color:#a6e22e">inputSource</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">buf</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
	}

	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">buf</span>.<span style="color:#a6e22e">Bytes</span>(), <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>gzipå¯¹æ–‡ä»¶æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œç¯‡å¹…åŸå› ï¼Œè¿™é‡Œåªè´´ä¸ªé“¾æ¥åœ°å€ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ï¼šhttps://github.com/hitzhangjie/codemaster/blob/master/compress/compress.goã€‚</p>
<p>å¥½ï¼Œç°åœ¨æˆ‘ä»¬å°†è¿™ä¸ªæ‰“åŒ…å·¥å…·çš„å®Œæ•´é€»è¾‘å†å®Œæ•´æ¢³ç†ä¸€ä¸‹ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {

	<span style="color:#75715e">// è¾“å…¥è¾“å‡ºå‚æ•°æ ¡éªŒ
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> len(<span style="color:#f92672">*</span><span style="color:#a6e22e">input</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> len(<span style="color:#f92672">*</span><span style="color:#a6e22e">gopkg</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;invalid argument: invalid input&#34;</span>)
		<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
	}

	<span style="color:#75715e">// è¯»å–è¾“å…¥å†…å®¹
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">buf</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ReadFromInputSource</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">input</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;read data error: %v\n&#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
	}

	<span style="color:#75715e">// å°†å†…å®¹è½¬æ¢æˆgoæ–‡ä»¶å†™å‡º
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">inputBaseName</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">filepath</span>.<span style="color:#a6e22e">Base</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">input</span>)
	<span style="color:#66d9ef">if</span> len(<span style="color:#f92672">*</span><span style="color:#a6e22e">output</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#f92672">*</span><span style="color:#a6e22e">output</span> = <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%s_bindata.go&#34;</span>, <span style="color:#a6e22e">inputBaseName</span>)
	}

	<span style="color:#a6e22e">outputDir</span>, <span style="color:#a6e22e">outputBaseName</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">filepath</span>.<span style="color:#a6e22e">Split</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">output</span>)
	<span style="color:#a6e22e">tplInstance</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">template</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">outputBaseName</span>).<span style="color:#a6e22e">Parse</span>(<span style="color:#a6e22e">tpl</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;parse template error: %v\n&#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
	}
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">MkdirAll</span>(<span style="color:#a6e22e">outputDir</span>, <span style="color:#ae81ff">0777</span>)

	<span style="color:#a6e22e">fout</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">OpenFile</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">output</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_CREATE</span>|<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_TRUNC</span>|<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_WRONLY</span>, <span style="color:#ae81ff">0666</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;open input error: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
	}

	<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">tplInstance</span>.<span style="color:#a6e22e">Execute</span>(<span style="color:#a6e22e">fout</span>, <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">struct</span> {
		<span style="color:#a6e22e">GoPackage</span> <span style="color:#66d9ef">string</span>
		<span style="color:#a6e22e">Variable</span>  <span style="color:#66d9ef">string</span>
		<span style="color:#a6e22e">Data</span>      []<span style="color:#66d9ef">uint8</span>
	}{
		<span style="color:#a6e22e">GoPackage</span>: <span style="color:#f92672">*</span><span style="color:#a6e22e">gopkg</span>,
		<span style="color:#a6e22e">Variable</span>:  <span style="color:#a6e22e">strcase</span>.<span style="color:#a6e22e">ToCamel</span>(<span style="color:#a6e22e">outputBaseName</span>),
		<span style="color:#a6e22e">Data</span>:      <span style="color:#a6e22e">buf</span>,
	})
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		panic(<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;template execute error: %v&#34;</span>, <span style="color:#a6e22e">err</span>))
	}

	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;ok, filedata stored to %s\n&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">output</span>)
}
</code></pre></div><p>ä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä¸‹å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå·¥å…·æ¥å¯¹é™æ€èµ„æºæ‰“åŒ…ã€‚</p>
<p>å‡å®šå­˜åœ¨å¦‚ä¸‹é™æ€èµ„æºç›®å½•staticï¼Œå…¶ä¸‹åŒ…å«äº†å¤šä¸ªæ–‡ä»¶ï¼Œç°åœ¨æˆ‘æƒ³å°†å…¶å…¨éƒ¨æ‰“åŒ…åˆ°ä¸€ä¸ªgoæ–‡ä»¶ä¸­ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ tree .

.
|- static
    |- file1.txt
    |- file2.txt
    |- file3.txt
</code></pre></div><p>è¿è¡Œ <code>go build -v bindata</code> ç¼–è¯‘æˆ‘ä»¬ä¹‹å‰å†™çš„å·¥å…·ï¼Œç„¶åè¿è¡Œ <code>bindata -input=path/to/static -output=goin/static.go -gopkg=gobin</code>ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ tree .

.
|- static
    |- file1.txt
    |- file2.txt
    |- file3.txt

|- gobin
    |- static.go
</code></pre></div><p>æˆ‘ä»¬çœ‹åˆ°å½“å‰ç›®å½•ä¸‹å¤šç”Ÿæˆäº†ä¸€ä¸ªgobinç›®å½•ï¼Œå…¶ä¸‹å¤šäº†ä¸ªgoæ–‡ä»¶static.goï¼ŒæŸ¥çœ‹ä¸‹æ–‡ä»¶å†…å®¹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat gobin/static.go

package gobin

var StaticGo <span style="color:#f92672">=</span> <span style="color:#f92672">[]</span>uint8<span style="color:#f92672">{</span>
31,139,8,0,0,0,0,0,0,255,236,213,193,10,194,48,12,128,225,158,125,138,62,129,36,77,219,60,79,15,171,171,136,7,91,65,124,122,105,39,131,29,244,182,58,89,190,75,24,140,209,145,253,44,166,203,128,199,242,40,106,61,0,0,222,218,54,217,187,54,193,76,215,13,178,66,98,240,236,25,136,21,32,121,100,165,97,197,51,205,238,185,132,155,2,120,142,225,122,58,167,225,211,125,185,132,24,191,60,231,253,42,243,252,19,101,76,89,167,172,235,119,160,241,240,235,227,136,206,234,222,205,150,250,183,78,250,239,104,209,191,145,254,247,166,238,157,182,212,191,155,254,255,134,164,255,30,22,253,147,244,47,132,16,123,241,10,0,0,255,255,106,242,211,179,0,16,0,0,
<span style="color:#f92672">}</span>
</code></pre></div><p>å“ˆå“ˆï¼Œç°åœ¨çœ‹åˆ°staticç›®å½•åŠå…¶ä¸‹çš„æ–‡ä»¶å·²ç»è¢«å®Œæ•´æ‰“åŒ…åˆ°ä¸€ä¸ªgoæ–‡ä»¶ä¸­äº†ï¼Œä¸”é€šè¿‡å¯¼å‡ºå˜é‡è¿›è¡Œäº†å¯¼å‡ºï¼Œåç»­ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆå°†å…¶è¿˜åŸåˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œä»¥å‰å·²ç»å†™å¥½çš„ä»£ç ä¸ç”¨åšä»»ä½•ä¿®æ”¹ï¼Œæ€ä¹ˆè¿˜åŸåˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå‘¢ï¼Œå¹¶ä½¿ç”¨å‘¢ï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// åœ¨ä½ éœ€è¦å¼•ç”¨è¿™äº›é™æ€èµ„æºçš„packageä¸­é‡Šæ”¾è¿™äº›é™æ€èµ„æºæ–‡ä»¶åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">init</span>() {
    <span style="color:#a6e22e">compress</span>.<span style="color:#a6e22e">UnTar</span>(<span style="color:#a6e22e">path</span><span style="color:#f92672">/</span><span style="color:#a6e22e">to</span><span style="color:#f92672">/</span><span style="color:#a6e22e">static</span>, <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">NewBuffer</span>(<span style="color:#a6e22e">gobin</span>.<span style="color:#a6e22e">StaticGo</span>))

    <span style="color:#a6e22e">val</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Read</span>(<span style="color:#a6e22e">path</span><span style="color:#f92672">/</span><span style="color:#a6e22e">to</span><span style="color:#f92672">/</span><span style="color:#a6e22e">static</span><span style="color:#f92672">/</span><span style="color:#a6e22e">file1</span>.<span style="color:#66d9ef">go</span>, <span style="color:#e6db74">&#34;section&#34;</span>, <span style="color:#e6db74">&#34;property&#34;</span>, <span style="color:#a6e22e">defaultValue</span>)
    <span style="color:#f92672">...</span>
}
</code></pre></div><p>ç°åœ¨ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è¶…çº§ç®€å•å‘¢ï¼Ÿ:)</p>

        </div>
        

        
        <hr>
        <div style="float:right;">
        


<div style="display:flex;">
    <div>åˆ†äº«ï¼š</div>
    <div>
        <div class="sharethis-inline-share-buttons"></div>
    </div>
</div>


        </div>

        <br>
        <br>

    </div>

    
    
    <br>
    <br>
    <div style="height:auto;align:center;text-align:center;"> 
        <div>
            <img src="/common/xiaoqi.png" style="height:238px;margin-top:10px;margin-right:5px;"/>
            <img src="/common/qrcode.jpg" style="height:238px;margin-top:10px;"/>
            <img src="/common/yuanbao.png" style="height:238px;margin-top:10px;margin-left:5px;"/>
        </div>

        <div>
            <p>
                æ„Ÿè°¢æ‰“èµï¼Œå°ä¸ƒğŸ¶ã€å…ƒå®ğŸ±å¯ä»¥æ”¹å–„ä¼™é£Ÿå’¯ ğŸ˜˜
            </p>
        </div>


    </div>
    

    </br>
    </br>
    
    <div class="container disqus">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-www-hitzhangjie-pro" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>



                
                <div class="container">
    <hr>
</div>
<div class="container has-text-centered top-pad">
    <a href="#top">
        <i class="fa fa-arrow-up"></i>
    </a>
</div>

<div class="container">
    <hr>
</div>

                <div class="section" id="footer">
    <div class="container has-text-centered">
    
        <span class="footer-text">
            <a href="https://github.com/victoriadrake/hugo-theme-introduction/"><strong>Introduction</strong></a> ä¸»é¢˜ä¸º <a href="http://gohugo.io/">Hugo</a> è€Œè®¾ã€‚ç”±å¼€æºç¤¾ç¾¤è´¡çŒ®è€…ä»¥ <a href="https://victoria.dev"><i class="fa fa-heart"></i> å’Œ <i class="fa fa-coffee"></i></a> åˆ›é€ ã€‚
        </span>
    
    </div>
</div>

                
            </div>
        </section>
        
        


<script src="https://www.hitzhangjie.pro/js/bundle.2ee571453a8980175e10bda96bda797cc9c4e2e745e488df68d50cef5deb57ff.js" integrity="sha256-LuVxRTqJgBdeEL2pa9p5fMnE4udF5IjfaNUM713rV/8="></script>





<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-168027530-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>








        
        
        
        
    </body>
</html>
